

using System;
using System.Threading;
using Microsoft.SPOT.Hardware;
using Microsoft.SPOT;
using TestSuite;
using Samraksh;

namespace TestSuite
{
    public class ADCTest
    {
        public ushort[] samples = new ushort[1000];
        public static OutputPort newPort = new OutputPort((Cpu.Pin)9, false);

        public void Run()
        {
            ADC.Init(0x04);
            
            ADC.ConfigureBatchMode(samples, 0, 2, 500, 1);
            
            AdcDoneEvent aEvent = new AdcDoneEvent("AdcCallback",0,100);
            NativeEventHandler eventHandler = new NativeEventHandler(OnNativeEvent);
            aEvent.OnInterrupt += eventHandler;
            
            
            
            while(true)
            {
            	Thread.Sleep(1000);
            }

        }
        
        static void OnNativeEvent(uint data1, uint data2, DateTime time)
        {
        	newPort.Write(true);
        	newPort.Write(false);
        	//for(uint i = 0; i < 1000; i++)
        	//	Debug.Print(samples[i]);
        }
    }
}